<!DOCTYPE html>
<html>
 <head>
    <title>D3.js Lab</title>
    <meta charset="UTF-8">
    <style type="text/css"></style>
 </head>
 <body>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script type="text/javascript">
    
    //Get the JSON Data
    $.getJSON("https://pkgstore.datahub.io/core/co2-ppm/co2-mm-mlo_json/data/aed7eb0d19cbcd90790525d40728b0a8/co2-mm-mlo_json.json", function (data)
    {
        console.log(data);
        plotCO2Data(data);
    });

    //Executed once file has been downloaded
    function plotCO2Data(data)
    {
        //Setup SVG size and margins
        var margin = {top: 50 , right: 50 , bottom: 50 , left: 50 },
        width = 900 - margin.left - margin.right,
        height = 670 - margin.top - margin.bottom;

        //Creating the x and y scales for interpolated C02 Value
        var y = d3.scaleLinear()
                .domain(d3.extent(data, function (d) {return d["Interpolated"] }))
                .range([height, 0]);

        var parseDate = d3.timeParse("%Y-%m-%d");

        var x = d3.scaleTime()
                .domain(d3.extent(data, function (d) {return parseDate( d["Date"]); }))
                .range([0, width]);

        //Axes
        //x is the scaleTime()
        var xAxis = d3.axisBotton(x)
                    .ticks(3);
        
        //y is the ScaleLinear
        var yAxis = d3.axisLeft(y)
                    .ticks(3);

        //Draw line - maps x,y corodinates for each data point, using x,y scale functions
        var valueline = d3.line()
                        .x(function (d) {return x(parseDate(d["Date"])); }) //x pixel
                        .y(function (d) {return y(d["Interpolated"]); }); //y pixel

        var svg = d3.select("body")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        
        svg.append("g") //Append to a <g> - group element
            .attr("class", "x axis")
            .call(xAxis);
        
        svg.append("g") //Append to a <g> - group element
            .attr("class", "y axis")
            .call(yAxis);

        svg.append("path") //Add the valueline path
            .attr("d", valueline(data));
    }
    </script>
    
 </body>
</html>